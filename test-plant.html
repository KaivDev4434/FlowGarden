<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Plant Animation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }
        
        .container {
            text-align: center;
        }
        
        .plant-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background: #4CAF50;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }
        
        button:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Plant Animation Test</h1>
        <div class="plant-container" id="plantContainer">
            <svg width="200" height="200" viewBox="0 0 200 200" class="plant-svg">
                <!-- Pot -->
                <path class="plant-pot" d="M 50 160 L 60 190 L 140 190 L 150 160 Z" 
                      fill="#8B4513" stroke="#654321" stroke-width="1"/>
                
                <!-- Soil -->
                <ellipse class="plant-soil" cx="100" cy="160" rx="45" ry="8" fill="#5D4037"/>
                
                <!-- Seed -->
                <ellipse class="plant-seed" cx="100" cy="155" rx="2" ry="3" 
                         fill="#5B3A29" opacity="0"/>
                
                <!-- Stem -->
                <rect class="plant-stem" x="98" y="155" width="4" height="0" 
                      fill="#228B22" rx="2"/>
                
                <!-- Lower Leaves -->
                <path class="plant-leaf leaf-1" d="M 100 135 Q 80 130 70 140 Q 80 150 100 135" 
                      fill="#2E8B57" opacity="0" style="transform-origin: 100px 135px"/>
                <path class="plant-leaf leaf-2" d="M 100 135 Q 120 130 130 140 Q 120 150 100 135" 
                      fill="#2E8B57" opacity="0" style="transform-origin: 100px 135px"/>
                
                <!-- Upper Leaves -->
                <path class="plant-leaf leaf-3" d="M 100 115 Q 85 110 77 118 Q 85 125 100 115" 
                      fill="#2E8B57" opacity="0" style="transform-origin: 100px 115px"/>
                <path class="plant-leaf leaf-4" d="M 100 115 Q 115 110 123 118 Q 115 125 100 115" 
                      fill="#2E8B57" opacity="0" style="transform-origin: 100px 115px"/>
                
                <!-- Flower Center -->
                <circle class="plant-flower-center" cx="100" cy="80" r="18" 
                        fill="#8B4513" opacity="0"/>
                
                <!-- Petals -->
                <g class="plant-petals" opacity="0">
                    <ellipse class="plant-petal" cx="100" cy="62" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px"/>
                    <ellipse class="plant-petal" cx="109" cy="65" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(30deg)"/>
                    <ellipse class="plant-petal" cx="115" cy="72" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(60deg)"/>
                    <ellipse class="plant-petal" cx="118" cy="80" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(90deg)"/>
                    <ellipse class="plant-petal" cx="115" cy="88" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(120deg)"/>
                    <ellipse class="plant-petal" cx="109" cy="95" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(150deg)"/>
                    <ellipse class="plant-petal" cx="100" cy="98" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(180deg)"/>
                    <ellipse class="plant-petal" cx="91" cy="95" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(210deg)"/>
                    <ellipse class="plant-petal" cx="85" cy="88" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(240deg)"/>
                    <ellipse class="plant-petal" cx="82" cy="80" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(270deg)"/>
                    <ellipse class="plant-petal" cx="85" cy="72" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(300deg)"/>
                    <ellipse class="plant-petal" cx="91" cy="65" rx="4" ry="10" fill="#FFD700" style="transform-origin: 100px 80px; transform: rotate(330deg)"/>
                </g>
            </svg>
        </div>
        
        <div class="controls">
            <button onclick="animateToSeed()">Seed (0-20%)</button>
            <button onclick="animateToSprout()">Sprout (21-40%)</button>
            <button onclick="animateToYoung()">Young (41-60%)</button>
            <button onclick="animateToMature()">Mature (61-80%)</button>
            <button onclick="animateToBlooming()">Blooming (81-100%)</button>
            <button onclick="animateWithering()" style="background: #ff6b6b;">Withering</button>
            <button onclick="animateToDeath()" style="background: #8b4513;">Death</button>
            <button onclick="celebrate()">Celebrate!</button>
        </div>
    </div>

    <script>
        const container = document.getElementById('plantContainer');
        
        function resetPlant() {
            // Hide leaves and flower center
            anime.set(container.querySelectorAll('.plant-leaf, .plant-flower-center'), {
                opacity: 0,
                scale: 0
            });
            
            // Hide petals group
            anime.set(container.querySelector('.plant-petals'), {
                opacity: 0
            });
            
            // Reset individual petals to scale 0 for animation
            anime.set(container.querySelectorAll('.plant-petal'), {
                scale: 0
            });
            
            // Reset stem to initial state but keep it visible
            anime.set(container.querySelector('.plant-stem'), {
                height: 0,
                y: 155,
                opacity: 1  // Keep stem visible!
            });
            
            anime.set(container.querySelector('.plant-seed'), { opacity: 0, scale: 0 });
        }
        
        function animateToSeed() {
            resetPlant();
            
            anime({
                targets: container.querySelector('.plant-seed'),
                opacity: [0, 1],
                scale: [0.5, 1],
                duration: 1500,
                easing: 'easeOutElastic(1, 0.5)'
            });
        }
        
        function animateToSprout() {
            anime.set(container.querySelector('.plant-seed'), { opacity: 1, scale: 1 });
            
            // Animate stem growth (stem is already visible from reset)
            anime({
                targets: container.querySelector('.plant-stem'),
                height: [0, 45],
                y: [155, 110],
                duration: 2000,
                easing: 'easeOutElastic(1, 0.3)',
                transformOrigin: 'bottom'
            });
        }
        
        function animateToYoung() {
            // Ensure we have the right base state
            anime.set(container.querySelector('.plant-seed'), { opacity: 1, scale: 1 });
            anime.set(container.querySelector('.plant-stem'), { height: 45, y: 110 });
            
            const timeline = anime.timeline();
            
            timeline.add({
                targets: container.querySelector('.plant-stem'),
                height: [45, 75],
                y: [110, 80],
                duration: 1000,
                easing: 'easeOutQuad'
            });
            
            timeline.add({
                targets: container.querySelectorAll('.leaf-1, .leaf-2'),
                opacity: [0, 1],
                scale: [0, 1],
                duration: 1000,
                easing: 'easeOutElastic(1, 0.5)',
                delay: anime.stagger(200)
            }, '-=500');
        }
        
        function animateToMature() {
            // Ensure we have the right base state
            anime.set(container.querySelector('.plant-seed'), { opacity: 1, scale: 1 });
            anime.set(container.querySelector('.plant-stem'), { height: 75, y: 80 });
            anime.set(container.querySelectorAll('.leaf-1, .leaf-2'), { opacity: 1, scale: 1 });
            
            anime({
                targets: container.querySelectorAll('.leaf-3, .leaf-4'),
                opacity: [0, 1],
                scale: [0, 1],
                duration: 1000,
                easing: 'easeOutElastic(1, 0.5)',
                delay: anime.stagger(150)
            });
            
            setTimeout(() => {
                startIdleAnimations();
            }, 1500);
        }
        
        function animateToBlooming() {
            // Ensure we have the right base state with ALL previous elements visible
            anime.set(container.querySelector('.plant-seed'), { opacity: 1, scale: 1 });
            anime.set(container.querySelector('.plant-stem'), { height: 75, y: 80 });
            anime.set(container.querySelectorAll('.plant-leaf'), { opacity: 1, scale: 1 });
            
            // Ensure petals are reset to scale 0 for animation
            anime.set(container.querySelector('.plant-petals'), { opacity: 0 });
            anime.set(container.querySelectorAll('.plant-petal'), { scale: 0 });
            
            const timeline = anime.timeline();
            
            timeline.add({
                targets: container.querySelector('.plant-flower-center'),
                opacity: [0, 1],
                scale: [0, 1],
                duration: 800,
                easing: 'easeOutElastic(1, 0.6)',
                transformOrigin: 'center'
            });
            
            timeline.add({
                targets: container.querySelector('.plant-petals'),
                opacity: [0, 1],
                duration: 300,
                easing: 'easeOutQuad'
            }, '-=400');
            
            timeline.add({
                targets: container.querySelectorAll('.plant-petal'),
                scale: [0, 1],
                duration: 2500,
                easing: 'easeOutElastic(1, 0.4)',
                delay: anime.stagger(80)
            }, '-=1200');
        }
        
        function animateWithering() {
            // Start from blooming state
            animateToBlooming();
            
            // Wait for blooming to complete, then start withering
            setTimeout(() => {
                const timeline = anime.timeline();
                
                // Wilt petals - change color and droop slightly
                timeline.add({
                    targets: container.querySelectorAll('.plant-petal'),
                    fill: '#DEB887', // Wilted brown-yellow color
                    rotate: function(el, i) {
                        const currentRotation = (i * 30) || 0; // Get current rotation
                        return [currentRotation, currentRotation + anime.random(-15, 15)];
                    },
                    scale: [1, 0.9],
                    duration: 2000,
                    easing: 'easeInOutQuad',
                    delay: anime.stagger(100)
                });
                
                // Wilt leaves - change color and droop
                timeline.add({
                    targets: container.querySelectorAll('.plant-leaf'),
                    fill: '#8FBC8F', // Wilted green-brown color
                    rotate: function() {
                        return anime.random(-15, 15);
                    },
                    scale: [1, 0.85],
                    duration: 2000,
                    easing: 'easeInOutQuad',
                    delay: anime.stagger(150)
                }, '-=1500');
                
                // Wilt stem - slight lean and color change
                timeline.add({
                    targets: container.querySelector('.plant-stem'),
                    fill: '#8B7355', // Wilted brown color
                    rotate: anime.random(-3, 3),
                    duration: 2000,
                    easing: 'easeInOutQuad'
                }, '-=1500');
                
                // Flower center dulls
                timeline.add({
                    targets: container.querySelector('.plant-flower-center'),
                    fill: '#654321', // Darker brown
                    scale: [1, 0.9],
                    duration: 1500,
                    easing: 'easeInOutQuad'
                }, '-=1000');
            }, 3000); // Wait for blooming animation
        }
        
        function animateToDeath() {
            // Start from withered state or ensure we have full plant
            animateWithering();
            
            // Wait for withering to complete, then death animation
            setTimeout(() => {
                const timeline = anime.timeline();
                
                // Petals fall off
                timeline.add({
                    targets: container.querySelectorAll('.plant-petal'),
                    translateY: function() {
                        return anime.random(60, 120);
                    },
                    translateX: function() {
                        return anime.random(-30, 30);
                    },
                    rotate: function() {
                        return anime.random(0, 360);
                    },
                    opacity: [1, 0.2],
                    scale: [0.9, 0.6],
                    duration: 2500,
                    easing: 'easeInQuad',
                    delay: anime.stagger(150)
                });
                
                // Leaves fall and fade
                timeline.add({
                    targets: container.querySelectorAll('.plant-leaf'),
                    translateY: function() {
                        return anime.random(40, 100);
                    },
                    translateX: function() {
                        return anime.random(-25, 25);
                    },
                    rotate: function() {
                        return anime.random(-180, 180);
                    },
                    opacity: [1, 0.1],
                    duration: 2000,
                    easing: 'easeInQuad',
                    delay: anime.stagger(200)
                }, '-=2000');
                
                // Stem collapses
                timeline.add({
                    targets: container.querySelector('.plant-stem'),
                    rotate: anime.random(-25, 25),
                    height: function(el) {
                        return el.getAttribute('height') * 0.6; // Shrink to 60%
                    },
                    opacity: [1, 0.3],
                    fill: '#5D4037', // Very dark brown
                    duration: 2000,
                    easing: 'easeInQuad'
                }, '-=1500');
                
                // Flower center fades
                timeline.add({
                    targets: container.querySelector('.plant-flower-center'),
                    opacity: [1, 0.2],
                    translateY: 15,
                    scale: [0.9, 0.7],
                    duration: 1500,
                    easing: 'easeInQuad'
                }, '-=1800');
                
                // Add some falling debris effect
                createDeathParticles();
            }, 5000); // Wait for withering animation
        }
        
        function createDeathParticles() {
            // Create small falling debris particles
            const particles = [];
            for (let i = 0; i < 6; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: absolute;
                    width: 2px;
                    height: 6px;
                    background: #8B4513;
                    border-radius: 1px;
                    pointer-events: none;
                    left: ${100 + anime.random(-20, 20)}px;
                    top: ${80 + anime.random(-10, 10)}px;
                `;
                container.appendChild(particle);
                particles.push(particle);
            }

            anime({
                targets: particles,
                translateY: [0, anime.random(40, 80)],
                translateX: function() {
                    return anime.random(-15, 15);
                },
                rotate: function() {
                    return anime.random(-180, 180);
                },
                opacity: [0.8, 0],
                duration: 3000,
                delay: anime.stagger(200),
                easing: 'easeInQuart',
                complete: () => {
                    particles.forEach(particle => particle.remove());
                }
            });
        }
        
        function startIdleAnimations() {
            anime({
                targets: container.querySelectorAll('.plant-leaf'),
                rotate: [-1, 1],
                duration: 4000,
                direction: 'alternate',
                loop: true,
                easing: 'easeInOutSine',
                delay: anime.stagger(200)
            });
        }
        
        function celebrate() {
            // Create sparkle particles
            const sparkles = [];
            for (let i = 0; i < 8; i++) {
                const sparkle = document.createElement('div');
                sparkle.style.cssText = `
                    position: absolute;
                    width: 4px;
                    height: 4px;
                    background: #FFD700;
                    border-radius: 50%;
                    pointer-events: none;
                    left: 100px;
                    top: 80px;
                `;
                container.appendChild(sparkle);
                sparkles.push(sparkle);
            }

            anime({
                targets: sparkles,
                translateX: () => anime.random(-40, 40),
                translateY: () => anime.random(-50, -15),
                scale: [0, 1.5, 0],
                opacity: [0, 1, 0],
                duration: 2000,
                delay: anime.stagger(100),
                easing: 'easeOutQuart',
                complete: () => {
                    sparkles.forEach(sparkle => sparkle.remove());
                }
            });
            
            anime({
                targets: container.querySelector('.plant-svg'),
                scale: [1, 1.1, 1],
                duration: 800,
                easing: 'easeOutElastic(1, .8)'
            });
        }
        
        // Start with seed
        animateToSeed();
    </script>
</body>
</html>

